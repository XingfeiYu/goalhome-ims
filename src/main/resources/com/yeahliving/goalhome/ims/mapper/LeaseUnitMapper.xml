<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yeahliving.goalhome.ims.dao.LeaseUnitMapper">

    <resultMap id="LeaseUnitResults" type="com.yeahliving.goalhome.ims.bean.GoHoObjContainer" autoMapping="true">
        <collection property="obj" javaType="ArrayList" ofType="com.yeahliving.goalhome.ims.bean.GoHoLeaseUnit" autoMapping="true"/>
    </resultMap>

    <insert id="add" parameterType="com.yeahliving.goalhome.ims.bean.GoHoLeaseUnit" keyProperty="id" useGeneratedKeys="true"
            flushCache="true">
        INSERT INTO lease_unit (entity_id, house_id, agent_id, comments)
        VALUES ( #{entity_id}, #{house_id}, #{agent_id}, #{comments})
    </insert>

    <select id="countAll" resultType="Integer">
        SELECT COUNT(*) FROM lease_unit
        <where>
            <if test="agent_id > 0">
                agent_id = #{agent_id}
            </if>
            <if test="unit_type > 0">
                AND unit_type = #{unit_type}
            </if>
            <if test="status > 0">
                AND status = #{status}
            </if>
        </where>
    </select>

    <select id="all" resultMap="LeaseUnitResults">
        SELECT * FROM lease_unit
        <where>
            <if test="agent_id > 0">
                agent_id = #{agent_id}
            </if>
            <if test="unit_type > 0">
                AND unit_type = #{unit_type}
            </if>
            <if test="status > 0">
                AND status = #{status}
            </if>
        </where>
        <if test="page != null">
            limit #{page.offset},#{page.pageSize}
        </if>
    </select>

</mapper>